Declare @CollectionID as varchar(8)
Declare @ProjectName as varchar(25)
Set @CollectionID = 'SMS00001'
Set @ProjectName = 'ACG'
Select
Distinct (VRS.Netbios_Name0) as 'Name',
Case when VRS.Client0 = 1 Then 'Yes' Else 'No' End 'Client',
Case when VRS.Active0 = 1 Then 'Yes' Else 'No' End 'Active',
Case when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 1 Then 'VMWare'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 IN('3','4')Then 'Desktop'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 IN('8','9','10','11','12','14') Then 'Laptop'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 6 Then 'Mini Tower'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 7 Then 'Tower'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 13 Then 'All in One'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 15 Then 'Space-Saving'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 17 Then 'Main System Chassis'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 21 Then 'Peripheral Chassis'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 22 Then 'Storage Chassis'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 23 Then 'Rack Mount Chassis'
when v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 24 Then 'Sealed-Case PC'
Else 'Others' End 'CaseType',
LEFT(MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.IPAddress0),
ISNULL(NULLIF(CHARINDEX(',',MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.IPAddress0)) - 1, -
1),LEN(MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.IPAddress0))))as 'IPAddress',
MAX (v_GS_NETWORK_ADAPTER_CONFIGUR.MACAddress0) as 'MACAddress',
v_RA_System_SMSAssignedSites.SMS_Assigned_Sites0 as 'AssignedSite',
VRS.Client_Version0 as 'ClientVersion',
VRS.Creation_Date0 as 'ClientCreationDate',
VRS.AD_Site_Name0 as 'ADSiteName',
dbo.v_GS_OPERATING_SYSTEM.InstallDate0 AS 'OSInstallDate',
DateDiff(D, dbo.v_GS_OPERATING_SYSTEM.InstallDate0, GetDate()) 'OSInstallDateAge',
Convert(VarChar, v_Gs_Operating_System.LastBootUpTime0,100) as 'LastBootDate',
DateDiff(D, Convert(VarChar, v_Gs_Operating_System.LastBootUpTime0,100), GetDate()) as
'LastBootDateAge',
PC_BIOS_DATA.SerialNumber00 as 'SerialNumber',
v_GS_SYSTEM_ENCLOSURE.SMBIOSAssetTag0 as 'AssetTag',
PC_BIOS_DATA.ReleaseDate00 as 'ReleaseDate',
PC_BIOS_DATA.Name00 as 'BiosName',
PC_BIOS_DATA.SMBIOSBIOSVersion00 as 'BiosVersion',
v_GS_PROCESSOR.Name0 as 'ProcessorName',
case when Computer_System_DATA.Manufacturer00 like 'VMware%' Then 'VMWare'
when Computer_System_DATA.Manufacturer00 like 'Gigabyte%' Then 'Gigabyte'
when Computer_System_DATA.Manufacturer00 like 'VIA Technologies%' Then 'VIA Technologies'
when Computer_System_DATA.Manufacturer00 like 'MICRO-STAR%' Then 'MICRO-STAR'
Else Computer_System_DATA.Manufacturer00 End 'Manufacturer',
Computer_System_DATA.Model00 as 'Model',
Computer_System_DATA.SystemType00 as 'OSType',
v_GS_COMPUTER_SYSTEM.Domain0 as 'DomainName',
VRS.User_Domain0+'\'+ VRS.User_Name0 as 'UserName',
v_R_User.Mail0 as 'EMailID',
Case when v_GS_COMPUTER_SYSTEM.domainrole0 = 0 then 'Standalone Workstation'
when v_GS_COMPUTER_SYSTEM.domainrole0 = 1 Then 'Member Workstation'
when v_GS_COMPUTER_SYSTEM.domainrole0 = 2 Then 'Standalone Server'
when v_GS_COMPUTER_SYSTEM.domainrole0 = 3 Then 'Member Server'
when v_GS_COMPUTER_SYSTEM.domainrole0 = 4 Then 'Backup Domain Controller'
when v_GS_COMPUTER_SYSTEM.domainrole0 = 5 Then 'Primary Domain Controller'
End 'Role',
case when Operating_System_DATA.Caption00 = 'Microsoft(R) Windows(R) Server 2003, Enterprise Edition'
Then 'Microsoft(R) Windows(R) Server 2003 Enterprise Edition'
when Operating_System_DATA.Caption00 = 'Microsoft(R) Windows(R) Server 2003, Standard Edition' Then
'Microsoft(R) Windows(R) Server 2003 Standard Edition'
when Operating_System_DATA.Caption00 = 'Microsoft(R) Windows(R) Server 2003, Web Edition' Then
'Microsoft(R) Windows(R) Server 2003 Web Edition'
when Operating_System_DATA.Caption00 = 'Microsoft Windows NT Workstation 6.1' Then
'Microsoft Windows NT Workstation 6.1'
Else Operating_System_DATA.Caption00 End 'OSName',
Operating_System_DATA.CSDVersion00 as 'ServicePack',
Operating_System_DATA.Version00 as 'Version',
((v_GS_X86_PC_MEMORY.TotalPhysicalMemory0/1024)/1000) as 'TotalRAMSize(GB)',
max(v_GS_LOGICAL_DISK.Size0 / 1024) AS 'TotalHDDSize(GB)',
v_GS_WORKSTATION_STATUS.LastHWScan as 'LastHWScan',
DateDiff(D, v_GS_WORKSTATION_STATUS.LastHwScan, GetDate()) as 'LastHWScanAge',
@ProjectName as 'AccountName'
from V_R_System VRS
Left Outer join PC_BIOS_DATA on PC_BIOS_DATA.MachineID = VRS.ResourceId
Left Outer join Operating_System_DATA on Operating_System_DATA.MachineID = VRS.ResourceId
Left Outer join v_GS_WORKSTATION_STATUS on v_GS_WORKSTATION_STATUS.ResourceID = VRS.ResourceId
Left Outer join Computer_System_DATA on Computer_System_DATA.MachineID = VRS.ResourceId
Left Outer join v_GS_X86_PC_MEMORY on v_GS_X86_PC_MEMORY.ResourceID = VRS.ResourceId
Left Outer join v_GS_PROCESSOR on v_GS_PROCESSOR.ResourceID = VRS.ResourceId
Left Outer join v_GS_SYSTEM_ENCLOSURE on v_GS_SYSTEM_ENCLOSURE.ResourceID = VRS.ResourceId
Left Outer join v_Gs_Operating_System on v_Gs_Operating_System .ResourceID = VRS.ResourceId
Left Outer join v_RA_System_SMSAssignedSites on v_RA_System_SMSAssignedSites.ResourceID =
VRS.ResourceId
left outer join v_GS_COMPUTER_SYSTEM on v_GS_COMPUTER_SYSTEM.ResourceID = VRS.ResourceId
left outer join v_FullCollectionMembership on v_FullCollectionMembership.ResourceID = VRS.ResourceId
left outer join v_GS_NETWORK_ADAPTER_CONFIGUR on v_GS_NETWORK_ADAPTER_CONFIGUR.ResourceID =
VRS.ResourceId
left outer join v_GS_LOGICAL_DISK on v_GS_LOGICAL_DISK.ResourceID = Vrs.ResourceId AND
v_GS_LOGICAL_DISK.DriveType0 = 3
Left Outer join v_R_User on VRS.User_Name0 = v_R_User.User_Name0
where VRS.Operating_System_Name_and0 like '%Workstation%'
and (VRS.Obsolete0 = 0 or VRS.Obsolete0 is null)
and v_FullCollectionMembership.CollectionID = @CollectionID
GROUP BY VRS.Netbios_Name0,VRS.Client0,VRS.Active0,v_GS_SYSTEM_ENCLOSURE.ChassisTypes0,
v_RA_System_SMSAssignedSites.SMS_Assigned_Sites0,VRS.Client_Version0,Vrs.Creation_Date0,
Vrs.AD_Site_Name0,v_Gs_Operating_System.InstallDate0,v_Gs_Operating_System.LastBootUpTime0,
PC_BIOS_DATA.SerialNumber00,v_GS_SYSTEM_ENCLOSURE.SMBIOSAssetTag0,PC_BIOS_DATA.ReleaseDate00,
PC_BIOS_DATA.Name00,PC_BIOS_DATA.SMBIOSBIOSVersion00,v_GS_PROCESSOR.Name0,Computer_System_DATA.Manufacturer00,
Computer_System_DATA.Model00,Computer_System_DATA.SystemType00,v_GS_COMPUTER_SYSTEM.Domain0,
Vrs.User_Domain0,Vrs.User_Name0,v_R_User.Mail0,v_GS_COMPUTER_SYSTEM.DomainRole0,Operating_System_DATA.Caption00,
Operating_System_DATA.CSDVersion00,Operating_System_DATA.Version00,v_GS_X86_PC_MEMORY.TotalPhysicalMemory0,v_GS_WORKSTATION_STATUS.LastHWScan
order by VRS.Netbios_Name0




------------------


SELECT 
    CS.Name0 AS ComputerName,
    TPM.SpecVersion0 As TPMVersion,
    TPM.IsEnabled_InitialValue0 AS TPM_Enabled,
    TPM.IsActivated_InitialValue0 AS TPM_Activated,
    TPM.IsOwned_InitialValue0 AS TPM_Owned,
    --SB.UEFISecureBootEnabled0 AS SecureBoot_Inv1,
    FW.SecureBoot0 AS SecureBoot,
    FW.UEFI0 AS UEFIMode
FROM 
    v_R_System CS
LEFT JOIN v_GS_PC_BIOS BIOS ON CS.ResourceID = BIOS.ResourceID
LEFT JOIN v_GS_TPM TPM ON CS.ResourceID = TPM.ResourceID
LEFT JOIN v_GS_Secure_Boot_State0 SB ON CS.ResourceID = SB.ResourceID
LEFT JOIN v_GS_Firmware FW ON CS.ResourceID = FW.ResourceID


--------------------



DECLARE @CollectionID AS VARCHAR(8)
DECLARE @ProjectName AS VARCHAR(25)
SET @CollectionID = 'SMS00001'
SET @ProjectName = 'ACG'

SELECT DISTINCT
    VRS.Netbios_Name0 AS 'Name',
    CASE WHEN VRS.Client0 = 1 THEN 'Yes' ELSE 'No' END AS 'Client',
    CASE WHEN VRS.Active0 = 1 THEN 'Yes' ELSE 'No' END AS 'Active',
    CASE 
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 1 THEN 'VMWare'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 IN ('3','4') THEN 'Desktop'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 IN ('8','9','10','11','12','14') THEN 'Laptop'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 6 THEN 'Mini Tower'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 7 THEN 'Tower'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 13 THEN 'All in One'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 15 THEN 'Space-Saving'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 17 THEN 'Main System Chassis'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 21 THEN 'Peripheral Chassis'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 22 THEN 'Storage Chassis'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 23 THEN 'Rack Mount Chassis'
        WHEN v_GS_SYSTEM_ENCLOSURE.ChassisTypes0 = 24 THEN 'Sealed-Case PC'
        ELSE 'Others'
    END AS 'CaseType',
    LEFT(MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.IPAddress0),
        ISNULL(NULLIF(CHARINDEX(',',MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.IPAddress0)) - 1, -1),
        LEN(MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.IPAddress0)))) AS 'IPAddress',
    MAX(v_GS_NETWORK_ADAPTER_CONFIGUR.MACAddress0) AS 'MACAddress',
    v_RA_System_SMSAssignedSites.SMS_Assigned_Sites0 AS 'AssignedSite',
    VRS.Client_Version0 AS 'ClientVersion',
    VRS.Creation_Date0 AS 'ClientCreationDate',
    VRS.AD_Site_Name0 AS 'ADSiteName',
    dbo.v_GS_OPERATING_SYSTEM.InstallDate0 AS 'OSInstallDate',
    DATEDIFF(D, dbo.v_GS_OPERATING_SYSTEM.InstallDate0, GETDATE()) AS 'OSInstallDateAge',
    CONVERT(VARCHAR, v_Gs_Operating_System.LastBootUpTime0, 100) AS 'LastBootDate',
    DATEDIFF(D, CONVERT(VARCHAR, v_Gs_Operating_System.LastBootUpTime0, 100), GETDATE()) AS 'LastBootDateAge',
    PC_BIOS_DATA.SerialNumber00 AS 'SerialNumber',
    v_GS_SYSTEM_ENCLOSURE.SMBIOSAssetTag0 AS 'AssetTag',
    PC_BIOS_DATA.ReleaseDate00 AS 'ReleaseDate',
    PC_BIOS_DATA.Name00 AS 'BiosName',
    PC_BIOS_DATA.SMBIOSBIOSVersion00 AS 'BiosVersion',
    v_GS_PROCESSOR.Name0 AS 'ProcessorName',
    CASE 
        WHEN Computer_System_DATA.Manufacturer00 LIKE 'VMware%' THEN 'VMWare'
        WHEN Computer_System_DATA.Manufacturer00 LIKE 'Gigabyte%' THEN 'Gigabyte'
        WHEN Computer_System_DATA.Manufacturer00 LIKE 'VIA Technologies%' THEN 'VIA Technologies'
        WHEN Computer_System_DATA.Manufacturer00 LIKE 'MICRO-STAR%' THEN 'MICRO-STAR'
        ELSE Computer_System_DATA.Manufacturer00 
    END AS 'Manufacturer',
    Computer_System_DATA.Model00 AS 'Model',
    Computer_System_DATA.SystemType00 AS 'OSType',
    v_GS_COMPUTER_SYSTEM.Domain0 AS 'DomainName',
    VRS.User_Domain0 + '\' + VRS.User_Name0 AS 'UserName',
    v_R_User.Mail0 AS 'EMailID',
    CASE 
        WHEN v_GS_COMPUTER_SYSTEM.domainrole0 = 0 THEN 'Standalone Workstation'
        WHEN v_GS_COMPUTER_SYSTEM.domainrole0 = 1 THEN 'Member Workstation'
        WHEN v_GS_COMPUTER_SYSTEM.domainrole0 = 2 THEN 'Standalone Server'
        WHEN v_GS_COMPUTER_SYSTEM.domainrole0 = 3 THEN 'Member Server'
        WHEN v_GS_COMPUTER_SYSTEM.domainrole0 = 4 THEN 'Backup Domain Controller'
        WHEN v_GS_COMPUTER_SYSTEM.domainrole0 = 5 THEN 'Primary Domain Controller'
    END AS 'Role',
    CASE 
        WHEN Operating_System_DATA.Caption00 = 'Microsoft(R) Windows(R) Server 2003, Enterprise Edition' THEN 'Microsoft(R) Windows(R) Server 2003 Enterprise Edition'
        WHEN Operating_System_DATA.Caption00 = 'Microsoft(R) Windows(R) Server 2003, Standard Edition' THEN 'Microsoft(R) Windows(R) Server 2003 Standard Edition'
        WHEN Operating_System_DATA.Caption00 = 'Microsoft(R) Windows(R) Server 2003, Web Edition' THEN 'Microsoft(R) Windows(R) Server 2003 Web Edition'
        WHEN Operating_System_DATA.Caption00 = 'Microsoft Windows NT Workstation 6.1' THEN 'Microsoft Windows NT Workstation 6.1'
        ELSE Operating_System_DATA.Caption00 
    END AS 'OSName',
    Operating_System_DATA.CSDVersion00 AS 'ServicePack',
    Operating_System_DATA.Version00 AS 'Version',
    ((v_GS_X86_PC_MEMORY.TotalPhysicalMemory0 / 1024) / 1000) AS 'TotalRAMSize(GB)',
    MAX(v_GS_LOGICAL_DISK.Size0 / 1024) AS 'TotalHDDSize(GB)',
    v_GS_WORKSTATION_STATUS.LastHWScan AS 'LastHWScan',
    DATEDIFF(D, v_GS_WORKSTATION_STATUS.LastHwScan, GETDATE()) AS 'LastHWScanAge',
    @ProjectName AS 'AccountName',

    -- TPM and Secure Boot additions
    TPM.SpecVersion0 AS TPMVersion,
    TPM.IsEnabled_InitialValue0 AS TPM_Enabled,
    TPM.IsActivated_InitialValue0 AS TPM_Activated,
    TPM.IsOwned_InitialValue0 AS TPM_Owned,
    FW.SecureBoot0 AS SecureBoot,
    FW.UEFI0 AS UEFIMode

FROM v_R_System VRS
LEFT JOIN PC_BIOS_DATA ON PC_BIOS_DATA.MachineID = VRS.ResourceId
LEFT JOIN Operating_System_DATA ON Operating_System_DATA.MachineID = VRS.ResourceId
LEFT JOIN v_GS_WORKSTATION_STATUS ON v_GS_WORKSTATION_STATUS.ResourceID = VRS.ResourceId
LEFT JOIN Computer_System_DATA ON Computer_System_DATA.MachineID = VRS.ResourceId
LEFT JOIN v_GS_X86_PC_MEMORY ON v_GS_X86_PC_MEMORY.ResourceID = VRS.ResourceId
LEFT JOIN v_GS_PROCESSOR ON v_GS_PROCESSOR.ResourceID = VRS.ResourceId
LEFT JOIN v_GS_SYSTEM_ENCLOSURE ON v_GS_SYSTEM_ENCLOSURE.ResourceID = VRS.ResourceId
LEFT JOIN v_Gs_Operating_System ON v_Gs_Operating_System.ResourceID = VRS.ResourceId
LEFT JOIN v_RA_System_SMSAssignedSites ON v_RA_System_SMSAssignedSites.ResourceID = VRS.ResourceId
LEFT JOIN v_GS_COMPUTER_SYSTEM ON v_GS_COMPUTER_SYSTEM.ResourceID = VRS.ResourceId
LEFT JOIN v_FullCollectionMembership ON v_FullCollectionMembership.ResourceID = VRS.ResourceId
LEFT JOIN v_GS_NETWORK_ADAPTER_CONFIGUR ON v_GS_NETWORK_ADAPTER_CONFIGUR.ResourceID = VRS.ResourceId
LEFT JOIN v_GS_LOGICAL_DISK ON v_GS_LOGICAL_DISK.ResourceID = VRS.ResourceId AND v_GS_LOGICAL_DISK.DriveType0 = 3
LEFT JOIN v_R_User ON VRS.User_Name0 = v_R_User.User_Name0

-- TPM and Secure Boot joins
LEFT JOIN v_GS_PC_BIOS BIOS ON VRS.ResourceID = BIOS.ResourceID
LEFT JOIN v_GS_TPM TPM ON VRS.ResourceID = TPM.ResourceID
LEFT JOIN v_GS_Secure_Boot_State0 SB ON VRS.ResourceID = SB.ResourceID
LEFT JOIN v_GS_Firmware FW ON VRS.ResourceID = FW.ResourceID

WHERE 
    VRS.Operating_System_Name_and0 LIKE '%Workstation%' AND
    (VRS.Obsolete0 = 0 OR VRS.Obsolete0 IS NULL) AND
    v_FullCollectionMembership.CollectionID = @CollectionID

GROUP BY 
    VRS.Netbios_Name0, VRS.Client0, VRS.Active0, v_GS_SYSTEM_ENCLOSURE.ChassisTypes0,
    v_RA_System_SMSAssignedSites.SMS_Assigned_Sites0, VRS.Client_Version0, VRS.Creation_Date0,
    VRS.AD_Site_Name0, v_Gs_Operating_System.InstallDate0, v_Gs_Operating_System.LastBootUpTime0,
    PC_BIOS_DATA.SerialNumber00, v_GS_SYSTEM_ENCLOSURE.SMBIOSAssetTag0, PC_BIOS_DATA.ReleaseDate00,
    PC_BIOS_DATA.Name00, PC_BIOS_DATA.SMBIOSBIOSVersion00, v_GS_PROCESSOR.Name0,
    Computer_System_DATA.Manufacturer00, Computer_System_DATA.Model00, Computer_System_DATA.SystemType00,
    v_GS_COMPUTER_SYSTEM.Domain0, VRS.User_Domain0, VRS.User_Name0, v_R_User.Mail0,
    v_GS_COMPUTER_SYSTEM.DomainRole0, Operating_System_DATA.Caption00,
    Operating_System_DATA.CSDVersion00, Operating_System_DATA.Version00,
    v_GS_X86_PC_MEMORY.TotalPhysicalMemory0, v_GS_WORKSTATION_STATUS.LastHWScan,
    TPM.SpecVersion0, TPM.IsEnabled_InitialValue0, TPM.IsActivated_InitialValue0, TPM.IsOwned_InitialValue0,
    FW.SecureBoot0, FW.UEFI0

ORDER BY VRS.Netbios_Name0;

