
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\WindowsCopilot]
"TurnOffWindowsCopilot"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot]
"TurnOffWindowsCopilot"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge]
"HubsSidebarEnabled"=dword:00000000

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer]
"DisableSearchBoxSuggestions"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer]
"DisableSearchBoxSuggestions"=dword:00000001
---------------------------------------------------
Defender Error Fix: https://www.windows11forums.com/threads/windows-11-defender-firewall-will-not-load.355/#post-3757
Defender Error Fix: https://techlou.com/fix-unable-to-delete-all-specified-values-error-in-registry-editor/
https://windowsforum.com/threads/win11-upgrade-2025-07-cu-causing-mpssvc-break.375192/
---------------------------------------------------


-----------

---------------
https://www.systemcenterdudes.com/deploy-windows-10-extended-security-update-key-with-intune-or-sccm/
function Get-SCCMUserCollections {
    <#
        .SYNOPSIS
            Returns the User Collections that apply to the currently logged-in user
            based on SCCM client policy (works offline, no VPN needed).
    #>

    # Get logged-in user
    $LoggedOnUser = (Get-WmiObject Win32_ComputerSystem).UserName
    if (-not $LoggedOnUser) {
        Write-Warning "No user is currently logged in."
        return
    }

    Write-Verbose "Logged in user: $LoggedOnUser"

    # Normalize username (DOMAIN\USERNAME â†’ DOMAIN/USERNAME)
    $LoggedOnUser = $LoggedOnUser.Replace("\", "\\")

    # Query SCCM User Policy namespace
    $Collections = Get-WmiObject `
        -Namespace "root\ccm\Policy\User" `
        -Class CCM_CollectionMembership `
        -ErrorAction SilentlyContinue

    if (-not $Collections) {
        Write-Warning "No SCCM user collections found. User policy may not be downloaded yet."
        return
    }

    # Format output
    $Output = $Collections | Select-Object `
        CollectionID,
        CollectionName,
        IsEnabled

    return $Output
}

---------------------
----------------------
function Get-SCCMUserCollections {
    <#
        .SYNOPSIS
            Returns the SCCM User Collections for the currently logged-in user.
    #>

    # Get logged-in user
    $user = (Get-WmiObject Win32_ComputerSystem).UserName
    if (-not $user) {
        Write-Warning "No logged-in user detected."
        return
    }

    $domain, $username = $user.Split("\")
    $ADUser = New-Object System.Security.Principal.NTAccount($domain, $username)
    $SID = $ADUser.Translate([System.Security.Principal.SecurityIdentifier]).Value

    $Namespace = "root\ccm\policy\User$SID"

    if (-not (Get-WmiObject -Namespace "root\ccm\policy" -List | Where-Object { $_.Name -match $SID })) {
        Write-Warning "User policy for $user not found. User may not have received SCCM user policy yet."
        return
    }

    $Collections = Get-WmiObject `
        -Namespace $Namespace `
        -Class CCM_CollectionMembership `
        -ErrorAction SilentlyContinue

    if (-not $Collections) {
        Write-Warning "No user collections found in SCCM user policy for $user."
        return
    }

    return $Collections | Select-Object CollectionID, CollectionName, IsEnabled
}

